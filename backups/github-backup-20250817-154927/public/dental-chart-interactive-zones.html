<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagramme Dentaire - Zones Interactives</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .dental-chart-container {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-section {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .image-container {
            position: relative;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            width: 100%;
            height: 600px;
        }
        
        .dental-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            opacity: 0.9;
        }
        
        .tooth-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .tooth-zone {
            position: absolute;
            width: 30px;
            height: 20px;
            border: 2px solid #3b82f6;
            background: rgba(59, 130, 246, 0.2);
            cursor: pointer;
            pointer-events: all;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #1f2937;
            border-radius: 4px;
            user-select: none;
        }
        
        .tooth-zone:hover {
            background: rgba(59, 130, 246, 0.4);
            border-color: #1d4ed8;
            transform: scale(1.1);
            z-index: 10;
        }
        
        .tooth-zone.selected {
            background: rgba(59, 130, 246, 0.6);
            border-color: #1d4ed8;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.8);
            z-index: 10;
        }
        
        .tooth-zone.dragging {
            opacity: 0.7;
            z-index: 100;
        }
        
        .info-section {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .tooth-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }
        
        .tooth-details {
            margin-top: 15px;
        }
        
        .tooth-details p {
            margin: 8px 0;
            color: #4a5568;
        }
        
        .no-selection {
            text-align: center;
            color: #718096;
            font-style: italic;
        }
        
        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn.secondary {
            background: #6b7280;
        }
        
        .btn.secondary:hover {
            background: #4b5563;
        }
        
        .btn.success {
            background: #10b981;
        }
        
        .btn.success:hover {
            background: #059669;
        }
        
        .stats {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .stats h4 {
            margin-top: 0;
            color: #2d3748;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .stat-item {
            background: #f7fafc;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #3b82f6;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #718096;
        }
        
        .history {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .history h4 {
            margin-top: 0;
            color: #2d3748;
        }
        
        .history-item {
            background: #f7fafc;
            padding: 8px 12px;
            border-radius: 4px;
            margin: 5px 0;
            font-size: 0.9em;
            color: #4a5568;
        }
        
        .controls {
            margin-top: 20px;
            text-align: center;
        }
        
        .image-info {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .image-info h5 {
            margin: 0 0 10px 0;
            color: #234e52;
        }
        
        .image-info p {
            margin: 5px 0;
            color: #2d3748;
            font-size: 0.9em;
        }
        
        .debug-info {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }
        
        .zone-controls {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .zone-controls h5 {
            margin: 0 0 10px 0;
            color: #0c4a6e;
        }
        
        .zone-controls p {
            margin: 5px 0;
            color: #0c4a6e;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <div class="header">
                <h1>🦷 Diagramme Dentaire - Zones Interactives</h1>
                <p>Version avec zones cliquables ajustables</p>
            </div>
            
            <div class="content">
                <div class="image-info">
                    <h5>📸 Image de Référence Directe</h5>
                    <p><strong>Source :</strong> Votre image réaliste de dents</p>
                    <p><strong>Fichier :</strong> dental-reference.jpg (71KB)</p>
                    <p><strong>Méthode :</strong> Zones cliquables ajustables</p>
                </div>
                
                <div class="debug-info">
                    <h5>🔧 Mode Debug</h5>
                    <p><strong>Instructions :</strong> Cliquez sur les zones bleues pour sélectionner les dents</p>
                    <p><strong>Dent sélectionnée :</strong> <span v-if="selectedTooth" style="color: #3b82f6; font-weight: bold;">{{ selectedTooth }}</span><span v-else style="color: #718096;">Aucune</span></p>
                    <p><strong>Total clics :</strong> {{ toothHistory.length }}</p>
                    <p><strong>Mode drag :</strong> <span v-if="dragMode" style="color: #10b981; font-weight: bold;">Activé</span><span v-else style="color: #6b7280;">Désactivé</span></p>
                </div>
                
                <div class="zone-controls">
                    <h5>🎯 Contrôles des Zones</h5>
                    <p><strong>Mode normal :</strong> Cliquez pour sélectionner une dent</p>
                    <p><strong>Mode drag :</strong> Cliquez et glissez pour déplacer les zones</p>
                    <p><strong>Réinitialiser :</strong> Remet toutes les zones à leur position par défaut</p>
                </div>
                
                <div class="dental-chart-container">
                    <div class="chart-section">
                        <h3>📊 Diagramme Dentaire Interactif</h3>
                        <div class="image-container">
                            <img src="/images/dental-reference.jpg?v=interactive&ts=202508062030" alt="Diagramme dentaire réaliste" class="dental-image">
                            <div class="tooth-overlay">
                                <!-- Dents supérieures (quadrants 1 et 2) -->
                                <!-- Quadrant 1 (droite supérieure) -->
                                <div class="tooth-zone" style="top: 25%; left: 45%;" data-tooth-id="11" draggable="true">11</div>
                                <div class="tooth-zone" style="top: 25%; left: 40%;" data-tooth-id="12" draggable="true">12</div>
                                <div class="tooth-zone" style="top: 25%; left: 35%;" data-tooth-id="13" draggable="true">13</div>
                                <div class="tooth-zone" style="top: 25%; left: 30%;" data-tooth-id="14" draggable="true">14</div>
                                <div class="tooth-zone" style="top: 25%; left: 25%;" data-tooth-id="15" draggable="true">15</div>
                                <div class="tooth-zone" style="top: 25%; left: 20%;" data-tooth-id="16" draggable="true">16</div>
                                <div class="tooth-zone" style="top: 25%; left: 15%;" data-tooth-id="17" draggable="true">17</div>
                                <div class="tooth-zone" style="top: 25%; left: 10%;" data-tooth-id="18" draggable="true">18</div>
                                
                                <!-- Quadrant 2 (gauche supérieure) -->
                                <div class="tooth-zone" style="top: 25%; left: 55%;" data-tooth-id="21" draggable="true">21</div>
                                <div class="tooth-zone" style="top: 25%; left: 60%;" data-tooth-id="22" draggable="true">22</div>
                                <div class="tooth-zone" style="top: 25%; left: 65%;" data-tooth-id="23" draggable="true">23</div>
                                <div class="tooth-zone" style="top: 25%; left: 70%;" data-tooth-id="24" draggable="true">24</div>
                                <div class="tooth-zone" style="top: 25%; left: 75%;" data-tooth-id="25" draggable="true">25</div>
                                <div class="tooth-zone" style="top: 25%; left: 80%;" data-tooth-id="26" draggable="true">26</div>
                                <div class="tooth-zone" style="top: 25%; left: 85%;" data-tooth-id="27" draggable="true">27</div>
                                <div class="tooth-zone" style="top: 25%; left: 90%;" data-tooth-id="28" draggable="true">28</div>
                                
                                <!-- Dents inférieures (quadrants 3 et 4) -->
                                <!-- Quadrant 3 (gauche inférieure) -->
                                <div class="tooth-zone" style="top: 65%; left: 55%;" data-tooth-id="31" draggable="true">31</div>
                                <div class="tooth-zone" style="top: 65%; left: 60%;" data-tooth-id="32" draggable="true">32</div>
                                <div class="tooth-zone" style="top: 65%; left: 65%;" data-tooth-id="33" draggable="true">33</div>
                                <div class="tooth-zone" style="top: 65%; left: 70%;" data-tooth-id="34" draggable="true">34</div>
                                <div class="tooth-zone" style="top: 65%; left: 75%;" data-tooth-id="35" draggable="true">35</div>
                                <div class="tooth-zone" style="top: 65%; left: 80%;" data-tooth-id="36" draggable="true">36</div>
                                <div class="tooth-zone" style="top: 65%; left: 85%;" data-tooth-id="37" draggable="true">37</div>
                                <div class="tooth-zone" style="top: 65%; left: 90%;" data-tooth-id="38" draggable="true">38</div>
                                
                                <!-- Quadrant 4 (droite inférieure) -->
                                <div class="tooth-zone" style="top: 65%; left: 45%;" data-tooth-id="41" draggable="true">41</div>
                                <div class="tooth-zone" style="top: 65%; left: 40%;" data-tooth-id="42" draggable="true">42</div>
                                <div class="tooth-zone" style="top: 65%; left: 35%;" data-tooth-id="43" draggable="true">43</div>
                                <div class="tooth-zone" style="top: 65%; left: 30%;" data-tooth-id="44" draggable="true">44</div>
                                <div class="tooth-zone" style="top: 65%; left: 25%;" data-tooth-id="45" draggable="true">45</div>
                                <div class="tooth-zone" style="top: 65%; left: 20%;" data-tooth-id="46" draggable="true">46</div>
                                <div class="tooth-zone" style="top: 65%; left: 15%;" data-tooth-id="47" draggable="true">47</div>
                                <div class="tooth-zone" style="top: 65%; left: 10%;" data-tooth-id="48" draggable="true">48</div>
                            </div>
                        </div>
                        <div class="controls">
                            <button @click="clearSelection" class="btn">🗑️ Effacer la sélection</button>
                            <button @click="selectRandomTooth" class="btn">🎲 Sélectionner aléatoire</button>
                            <button @click="toggleDragMode" class="btn" :class="{ 'success': dragMode }">🎯 Mode Drag</button>
                            <button @click="resetZones" class="btn secondary">🔄 Réinitialiser zones</button>
                            <button @click="refreshPage" class="btn">🔄 Actualiser la page</button>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div v-if="selectedTooth" class="tooth-info">
                            <h3>🦷 Dent sélectionnée : {{ selectedTooth }}</h3>
                            <div class="tooth-details">
                                <p><strong>Type :</strong> {{ getToothType(selectedTooth) }}</p>
                                <p><strong>Quadrant :</strong> {{ getQuadrant(selectedTooth) }}</p>
                                <p><strong>Position :</strong> {{ getPosition(selectedTooth) }}</p>
                            </div>
                        </div>
                        <div v-else class="no-selection">
                            <h3>👆 Cliquez sur une zone bleue</h3>
                            <p>Les zones cliquables sont visibles en bleu</p>
                        </div>
                        
                        <div class="stats">
                            <h4>📈 Statistiques</h4>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-number">{{ toothHistory.length }}</div>
                                    <div class="stat-label">Sélections</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">{{ uniqueTeeth.length }}</div>
                                    <div class="stat-label">Dents uniques</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="history">
                            <h4>📝 Historique des sélections</h4>
                            <div v-for="(tooth, index) in toothHistory.slice(-5)" :key="index" class="history-item">
                                {{ tooth }} ({{ getToothType(tooth) }})
                            </div>
                            <div v-if="toothHistory.length === 0" class="no-selection">
                                Aucune sélection encore
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const { createApp, ref, computed } = Vue;
        
        createApp({
            setup() {
                const selectedTooth = ref(null);
                const toothHistory = ref([]);
                const dragMode = ref(false);
                
                const uniqueTeeth = computed(() => {
                    return [...new Set(toothHistory.value)];
                });
                
                const initializeDentalChart = () => {
                    console.log('Diagramme dentaire interactif initialisé');
                    setupZoneEvents();
                };
                
                const setupZoneEvents = () => {
                    const toothZones = document.querySelectorAll('.tooth-zone');
                    toothZones.forEach(zone => {
                        // Événement de clic pour sélection
                        zone.addEventListener('click', function(e) {
                            if (!dragMode.value) {
                                e.preventDefault();
                                e.stopPropagation();
                                const toothId = this.getAttribute('data-tooth-id');
                                selectTooth(toothId);
                                console.log('Zone cliquée:', toothId);
                            }
                        });
                        
                        // Événements de drag
                        zone.addEventListener('mousedown', function(e) {
                            if (dragMode.value) {
                                this.classList.add('dragging');
                                this.style.cursor = 'grabbing';
                            }
                        });
                        
                        zone.addEventListener('mouseup', function(e) {
                            if (dragMode.value) {
                                this.classList.remove('dragging');
                                this.style.cursor = 'grab';
                            }
                        });
                        
                        zone.addEventListener('dragstart', function(e) {
                            if (dragMode.value) {
                                e.dataTransfer.setData('text/plain', this.getAttribute('data-tooth-id'));
                            }
                        });
                        
                        zone.addEventListener('dragend', function(e) {
                            if (dragMode.value) {
                                this.classList.remove('dragging');
                            }
                        });
                    });
                };
                
                const selectTooth = (toothId) => {
                    // Désélectionner la dent précédemment sélectionnée
                    if (selectedTooth.value) {
                        const prevZone = document.querySelector(`[data-tooth-id="${selectedTooth.value}"]`);
                        if (prevZone) {
                            prevZone.classList.remove('selected');
                        }
                    }
                    
                    // Sélectionner la nouvelle dent
                    selectedTooth.value = toothId;
                    const zone = document.querySelector(`[data-tooth-id="${toothId}"]`);
                    if (zone) {
                        zone.classList.add('selected');
                    }
                    
                    toothHistory.value.push(toothId);
                    console.log('Dent sélectionnée:', toothId);
                };
                
                const clearSelection = () => {
                    selectedTooth.value = null;
                    const selectedZone = document.querySelector('.tooth-zone.selected');
                    if (selectedZone) {
                        selectedZone.classList.remove('selected');
                    }
                };
                
                const selectRandomTooth = () => {
                    const teeth = ['11', '12', '13', '14', '15', '16', '17', '18',
                                  '21', '22', '23', '24', '25', '26', '27', '28',
                                  '31', '32', '33', '34', '35', '36', '37', '38',
                                  '41', '42', '43', '44', '45', '46', '47', '48'];
                    const randomTooth = teeth[Math.floor(Math.random() * teeth.length)];
                    selectTooth(randomTooth);
                };
                
                const toggleDragMode = () => {
                    dragMode.value = !dragMode.value;
                    const zones = document.querySelectorAll('.tooth-zone');
                    zones.forEach(zone => {
                        if (dragMode.value) {
                            zone.style.cursor = 'grab';
                            zone.draggable = true;
                        } else {
                            zone.style.cursor = 'pointer';
                            zone.draggable = false;
                        }
                    });
                };
                
                const resetZones = () => {
                    // Réinitialiser les positions des zones
                    const zones = document.querySelectorAll('.tooth-zone');
                    const defaultPositions = {
                        '11': 'top: 25%; left: 45%;', '12': 'top: 25%; left: 40%;', '13': 'top: 25%; left: 35%;', '14': 'top: 25%; left: 30%;',
                        '15': 'top: 25%; left: 25%;', '16': 'top: 25%; left: 20%;', '17': 'top: 25%; left: 15%;', '18': 'top: 25%; left: 10%;',
                        '21': 'top: 25%; left: 55%;', '22': 'top: 25%; left: 60%;', '23': 'top: 25%; left: 65%;', '24': 'top: 25%; left: 70%;',
                        '25': 'top: 25%; left: 75%;', '26': 'top: 25%; left: 80%;', '27': 'top: 25%; left: 85%;', '28': 'top: 25%; left: 90%;',
                        '31': 'top: 65%; left: 55%;', '32': 'top: 65%; left: 60%;', '33': 'top: 65%; left: 65%;', '34': 'top: 65%; left: 70%;',
                        '35': 'top: 65%; left: 75%;', '36': 'top: 65%; left: 80%;', '37': 'top: 65%; left: 85%;', '38': 'top: 65%; left: 90%;',
                        '41': 'top: 65%; left: 45%;', '42': 'top: 65%; left: 40%;', '43': 'top: 65%; left: 35%;', '44': 'top: 65%; left: 30%;',
                        '45': 'top: 65%; left: 25%;', '46': 'top: 65%; left: 20%;', '47': 'top: 65%; left: 15%;', '48': 'top: 65%; left: 10%;'
                    };
                    
                    zones.forEach(zone => {
                        const toothId = zone.getAttribute('data-tooth-id');
                        if (defaultPositions[toothId]) {
                            zone.style = defaultPositions[toothId];
                        }
                    });
                    
                    clearSelection();
                };
                
                const refreshPage = () => {
                    window.location.reload();
                };
                
                const getToothType = (toothId) => {
                    const position = parseInt(toothId.slice(1));
                    if (position <= 2) return 'Incisive';
                    if (position === 3) return 'Canine';
                    if (position <= 5) return 'Prémolaire';
                    return 'Molaire';
                };
                
                const getQuadrant = (toothId) => {
                    const quadrant = toothId.slice(0, 1);
                    const names = {
                        '1': 'Supérieur Droit',
                        '2': 'Supérieur Gauche', 
                        '3': 'Inférieur Gauche',
                        '4': 'Inférieur Droit'
                    };
                    return names[quadrant] || 'Inconnu';
                };
                
                const getPosition = (toothId) => {
                    return toothId.slice(1);
                };
                
                // Initialiser quand le DOM est prêt
                document.addEventListener('DOMContentLoaded', initializeDentalChart);
                
                return {
                    selectedTooth,
                    toothHistory,
                    uniqueTeeth,
                    dragMode,
                    initializeDentalChart,
                    selectTooth,
                    clearSelection,
                    selectRandomTooth,
                    toggleDragMode,
                    resetZones,
                    refreshPage,
                    getToothType,
                    getQuadrant,
                    getPosition
                };
            }
        }).mount('#app');
    </script>
</body>
</html> 